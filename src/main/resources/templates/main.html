<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE-edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PINY</title>
    <!-- MATERIAL CON -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Sharp" rel="stylesheet"/>
    <!-- STYLESHEET -->
    <link rel="stylesheet" href="../css/style.css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp:opsz,wght,FILL,GRAD@24,400,0,0" />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  </head>
  <body>
    <div class="container">
        <aside>
            <div class="top">
                <div class="logo">
                    <img src="../images/logo.png">
                    <h2>PINY<span class="danger"> Catch U</span></h2>
                </div>
                <div class="close" id="close-btn">
                    <span class="material-icons-sharp">close</span>
                </div>
            </div>

            <div class="sidebar">
                <a class="menu-item active" href="/main">
                    <span class="material-icons-sharp">grid_view</span>
                    <h3>Dashboard</h3>
                </a>
                <a class="menu-item" href="/mypage">
                    <span class="material-icons-sharp">person_outline</span>
                    <h3>My page</h3>
                </a>
                <a class="menu-item" href="/video">
                    <span class="material-icons-sharp">videocam</span>
                    <h3>Video Streaming</h3>
                </a>
                <a class="menu-item" href="/storage">
                    <span class="material-icons-sharp">view_list</span>
                    <h3>Video List</h3>
                    <span class="message-count active" th:text="${session.countCheck}"></span>
                </a>
                <a class="menu-item" href="/map">
                    <span class="material-icons-sharp">public</span>
                    <h3>No Smoking Map</h3>
                </a>
                <a href="/logout">
                    <span class="material-icons-sharp">logout</span>
                    <h3>Logout</h3>
                </a>
            </div>
        </aside>
        <!-- ------------ END OF ASIDE ------------ -->
        <main>
            <h1>Dashboard</h1>

            <div class="date">
                <input type="date">
            </div>

            <div class="insights">
                <div class="sales">
                    <a href="/video"><span class="material-icons-sharp">videocam</span></a>
                    <div class="middle">
                        <div class="left">
                            <h3>실시간 CCTV</h3>
                            <h1>작동중</h1>
                        </div>
                    </div>
                </div>
                <!-- ------------ END OF SALES ------------ -->
                <div class="expenses">
                    <span class="material-icons-sharp">notifications</span>
                    <div class="middle">
                        <div class="left">
                            <h3>확인 필요한 감지알림</h3>
                            <h1 id="countCheck" th:text="${session.countCheck}+' 건'"></h1>
                        </div>
                    </div>
                </div>
                <!-- ------------ END OF EXPENSES ------------ -->
                <div class="income">
                    <span class="material-icons-sharp">bar_chart</span>
                    <div class="middle">
                        <div class="left">
                            <h3 id="countSmokeDay">TODAY 총 적발건수</h3>
                            <h1 id="countSmoke" th:text="${session.countSmoke}+' 건'"></h1>
                        </div>
                    </div>
                </div>
                <!-- ------------ END OF INCOME ------------ -->
            </div>
            <!-- ------------ END OF INSIGHTS ------------ -->
            <div class="recent-video">
                <h2>영상 증거물 업데이트</h2>
                <table>
                    <thead>
                        <tr>
                            <th>기록 번호</th>
                            <th>감지 일시</th>
                            <th>확인 여부</th>
                            <th>비디오 재생</th>
                        </tr>
                    </thead>
                    <tbody>
                    	<tr th:each="s : ${session.result_storage2}">
                            <td th:text="${s.idx}">Index</td>
                            <td th:text="${s.record_start}">Record Start</td>
                            <td th:if="${s.confirmed == 0}" class="primary"><i class="fa-sharp fa-solid fa-circle-xmark"></i><span th:text ="${s.confirmed}" style="display: none;">storage.confirmed</span></td>
                            <td th:if="${s.confirmed == 1}"><i class="fa-solid fa-circle-check" style="color: #00ff7b;"></i></td>
                            <td th:text = "${s.video_path}" style="display: none;">storage.video_path</td>
                            <td><a th:href="'storage/' + ${s.video_path}">Play Video</a></td>
                        </tr>
                        
                    </tbody>
                </table>
                <a href="/storage">Show All</a>
                
            </div>
        </main>
        <!-- ------------ END OF MAIN ------------ -->

        <div class="right">
            <div class="top">
                <button id="menu-btn">
                    <span class="material-icons-sharp">menu</span>
                </button>
                <div class="theme-toggler">
                    <span class="material-icons-sharp active">light_mode</span>
                    <span class="material-icons-sharp">dark_mode</span>
                </div>
                <div class="profile">
                    <div class="info">
                        <p>Hey, <b th:text="${session.loginMember.id}"></b></p>
                        <small class="text-muted" th:text="${session.loginMember.email}"></small>
                    </div>
                    <div class="profile-photo">
                        <img src="../images/profile2.jpg" alt="">
                    </div>
                </div>
            </div>
            <!-- END OF TOP -->
            <div class="recent-updates">
                <iframe src="https://www.google.co.kr/maps/d/embed?mid=1yzdWIFxpGE6zvCh1JwHksyw-vE1saxo&amp;ehbc=2E312F" width="300" height="300"></iframe>
                <!-- <h2>Recent Updates</h2>
                <div class="updates">
                    <div class="update">
                        <div class="profile-photo">
                            <img src="../images/profile1.png">
                        </div>
                        <div class="message">
                            <p><b>김동엽</b> 오늘자 현황 보고 부탁드려요</p>
                            <small class="text-muted">2 Minute Ago</small>
                        </div>
                    </div>
                    <div class="update">
                        <div class="profile-photo">
                            <img src="../images/profile1.png">
                        </div>
                        <div class="message">
                            <p><b>김도훈</b> 적발건 업데이트 되었습니다. 이메일로 자료 보냈습니다.</p>
                            <small class="text-muted">10 Minute Ago</small>
                        </div>
                    </div>
                    <div class="update">
                        <div class="profile-photo">
                            <img src="../images/profile1.png">
                        </div>
                        <div class="message">
                            <p><b>안상우</b> 이수역 1번 출구 앞 금연구역에서 흡연 적발되었습니다. 처리 부탁드려요~</p>
                            <small class="text-muted">15 Minute Ago</small>
                        </div>
                    </div>
                </div> -->
            </div>
            <!-- <table class="scriptCalendar">
                <thead>
                    <tr>
                        <td class="calendarBtn" id="btnPrevCalendar">&#60;&#60;</td>
                        <td colspan="5">
                            <span id="calYear">YYYY</span>년
                            <span id="calMonth">MM</span>월
                        </td>
                        <td class="calendarBtn" id="nextNextCalendar">&#62;&#62;</td>
                    </tr>
                    <tr>
                        <td>일</td><td>월</td><td>화</td><td>수</td><td>목</td><td>금</td><td>토</td>
                    </tr>
                </thead>
                <tbody></tbody>
            </table> -->
            <div class="calendar-container">
                <div class="calendar">
                    <div class="calendar-header">
                        <span class="month-picker" id="month-picker">May </span>
                        <div class="year-picker" id="year-picker">
                            <span class="year-change" id="pre-year">
                                <pre><</pre>
                            </span>
                            <span id="year">2023 </span>
                            <span class="year-change" id="next-year">
                                <pre>></pre>
                            </span>
                        </div>
                    </div>

                    <div class="calender-body">
                        <div class="calendar-week-days">
                            <div>Sun</div>
                            <div>Mon</div>
                            <div>Tue</div>
                            <div>Wed</div>
                            <div>Thu</div>
                            <div>Fri</div>
                            <div>Sat</div>
                        </div>
                        <div class="calendar-days"></div>
                    </div>
                    <div class="calendar-footer"></div>
                    <div class="month-list"></div>
                </div>
            </div>
        </div>
    <script src="https://kit.fontawesome.com/f3aa567758.js" crossorigin="anonymous"></script>
    <script src="../js/main.js"></script>
    <script>
      $(document).ready(function () {
        $("#sendEmailButton").click(function (event) {
          event.preventDefault(); // 버튼의 기본 동작 중지 (페이지 이동 방지)

          // AJAX 요청
          $.ajax({
            url: "/sendemail", // 이메일 전송을 처리하는 URL
            type: "POST", // 전송 방식 (POST)
            success: function (response) {
              alert("이메일이 성공적으로 전송되었습니다!");
              // 성공 시 수행할 작업 추가
            },
            error: function (xhr, status, error) {
              alert("이메일 전송에 실패했습니다!");
              // 실패 시 수행할 작업 추가
            },
          });
        });
      });
    </script>
  </body>
</html>